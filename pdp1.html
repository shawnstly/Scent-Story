<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scent Story â€” Explore our Collections (EDP â€¢ Parfum â€¢ Elixir)</title>
  <!-- Fonts / Icons / Shared Styles -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <style>
    /* ===== Image-only catalog + filters ===== */
    .filters{ display:flex; flex-wrap:wrap; align-items:center; gap:10px; margin:14px 0 18px; }
    .filter-group{ display:flex; align-items:center; gap:8px; }
    .chip-filter{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid var(--stroke); border-radius:999px; background:#0f1216; color:#EDEDED; cursor:pointer; transition:transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease; }
    .chip-filter:hover{ transform:translateY(-1px); box-shadow:0 8px 18px rgba(229,182,79,.18) }
    .chip-filter.active{ background:#ffc400; color:#111; border-color:#ffc400; }
    #occasion-filter{ appearance:none; padding:8px 12px; background:#0f1216; color:#EDEDED; border:1px solid var(--stroke); border-radius:10px; }
    #search{ padding:8px 12px; background:#0f1216; color:#EDEDED; border:1px solid var(--stroke); border-radius:10px; min-width:220px }

    .image-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:20px; align-items:stretch }
    @media (max-width:1024px){ .image-grid{ grid-template-columns: repeat(2, 1fr); } }
    @media (max-width:640px){ .image-grid{ grid-template-columns: 1fr; } }

    .tile{ position:relative; border:1px solid var(--stroke); border-radius:14px; overflow:hidden; background:#0f1216; opacity:0; transform: translateY(10px) scale(.98); transition: opacity .35s ease, transform .35s ease }
    .tile.reveal{ opacity:1; transform: translateY(0) scale(1) }
    .tile .img-stack{ position:relative; width:100%; height:480px; overflow:hidden }
    .tile .img-stack img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; transition:opacity .28s ease, transform .28s ease }
    .tile .img-primary{ opacity:1; transform:scale(1) }
    .tile .img-alt{ opacity:0; transform:scale(1.02) }
    .tile:focus-within .img-primary, .tile:hover .img-primary{ opacity:0; transform:scale(.985) }
    .tile:focus-within .img-alt, .tile:hover .img-alt{ opacity:1; transform:scale(1) }

    .tile .caption{ position:absolute; left:0; right:0; bottom:0; padding:10px 12px; background: linear-gradient(180deg, transparent, rgba(0,0,0,.55)); color:#fff; font-weight:600; letter-spacing:.02em }
    .tile .meta{ display:flex; gap:8px; position:absolute; top:10px; left:10px }
    .tile .pill{ background:#ffc400; color:#111; border-radius:999px; padding:4px 8px; border:1px solid var(--stroke); font-weight:700; font-size:12px }

    /* Chip pulse + ripple feedback on category click */
    .chip-filter.active{ position:relative; box-shadow:0 0 0 0 rgba(255,196,0,.45); animation: chipPulse 1.6s ease-out; }
    @keyframes chipPulse{ 0%{ box-shadow:0 0 0 0 rgba(255,196,0,.45) } 70%{ box-shadow:0 0 0 12px rgba(255,196,0,0) } 100%{ box-shadow:0 0 0 0 rgba(255,196,0,0) } }

    /* Confetti burst */
    .confetti{ position:absolute; width:6px; height:6px; background:#ffc400; top:50%; left:50%; transform:translate(-50%,-50%); border-radius:2px; pointer-events:none; animation: confettiPop .8s ease-out forwards }
    @keyframes confettiPop{ 0%{ opacity:1; transform:translate(-50%,-50%) scale(1) } 100%{ opacity:0; transform:translate(var(--dx), var(--dy)) scale(.6) } }

    /* Reduce tile height on small screens */
    @media (max-width:900px){ .tile .img-stack{ height:360px } }

    /* Global font + color alignment (match site) */
    html, body, h1, h2, h3, h4, h5, h6, p, a, li, nav, button, input, textarea { font-family: 'Playfair Display', serif !important; }
    h1,h2,h3,h4,h5,h6,.section-title { color:#fff; }
    p, li { color: var(--muted); }
    a{ color: inherit; text-decoration: none; }

    /* Header brand styles (mirror index/pdp) */
    .brand-logo{ display:inline-flex; align-items:center; justify-content:flex-start; width:auto; height:auto; border:0; background:transparent; overflow:visible }
    .brand-logo img{ height:96px; width:auto; display:block; object-fit:contain; animation: logoGlow 3s infinite ease-in-out; }
    .brand-text{ font-size:21px; font-weight:600; color:#fff; margin-left:-25px; margin-right:40px; letter-spacing:.02em; animation: logoGlow 4.5s infinite ease-in-out; }
    @media (max-width:768px){ .brand-logo img{ height:72px } .brand-text{ font-size:22px; margin-left:-16px; margin-right:20px } }
    @keyframes logoGlow { 0%,100%{ filter:none; transform:none } 50%{ filter: drop-shadow(0 0 16px rgba(255,196,0,.75)) drop-shadow(0 0 32px rgba(255,196,0,.5)); transform: scale(1.02) } }
    @media (prefers-reduced-motion: reduce){ .brand-logo img, .brand-text{ animation:none } }

    /* Quick actions (Account / Orders) â€” color & icon styles */
    .quick-actions{ display:flex; align-items:center; gap:12px; }
    .icon-btn{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border:1px solid var(--stroke); border-radius:999px; background:transparent; color:#EDEDED; text-decoration:none; font-weight:600; letter-spacing:.02em; transition: transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease, border-color .2s ease; }
    .icon-btn i{ font-size:16px; line-height:1; }
    .icon-btn:hover{ transform: translateY(-1px); background:#111418; color:#ffc400; border-color:#ffc400; box-shadow:0 10px 22px rgba(229,182,79,.22); }
    .icon-btn:active{ transform: translateY(0); box-shadow:0 6px 14px rgba(229,182,79,.18); }

    /* Navbar height (mirror index) */
    .nav{ display:flex; align-items:center; gap:20px; justify-content:space-between; min-height:120px; padding:8px 20px }
    @media (max-width:768px){ .nav{ min-height:92px; padding:6px 14px; gap:10px } }

    /* Catalog layout */

    /* Buttons â€” copied from index */
    .btn-gold, .btn-outline {
      padding: 12px 16px;
      border-radius: 999px;
      font-weight: 700;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
    }
    .btn-gold { background: var(--accent); color: #111; border: 1px solid rgba(0,0,0,.25); }
    .btn-gold:hover { transform: translateY(-1px); box-shadow: 0 10px 22px rgba(229,182,79,.25); background:#f0c96a; }
    .btn-outline { background: transparent; border: 1px solid var(--stroke); color: #EDEDED; }
    .btn-outline:hover { color:#111; background: #EDEDED; }

    /* subtle glow/pulse used on CTAs in index */
    .pulse-glow { animation: pulseGlow 2.4s infinite ease-in-out; }
    @keyframes pulseGlow { 0%,100%{ box-shadow:0 0 0 0 rgba(255,196,0,0) } 50%{ box-shadow:0 0 18px rgba(255,196,0,.35) } }

    /* small spacing above member button for clarity */
    .membership-card .member-btn { margin-top: 8px; display:inline-flex; align-items:center; justify-content:center; }
    .catalog{ padding: 24px 0 40px; }
    .catalog h2{ margin: 14px 0 18px; letter-spacing:.03em; }
    .catalog .grid{ display:grid; grid-template-columns:1fr; gap: 40px; }

    /* Individual product PDP-like block (kept for future expansion) */
    .product-block{ display:grid; grid-template-columns: 1.05fr .95fr; gap:24px; align-items:start; border:1px solid var(--stroke); border-radius:16px; padding:18px; background:linear-gradient(180deg,#0b0d10,#0e1116) }
    @media (max-width: 1024px){ .product-block{ grid-template-columns:1fr } }

    /* Footer nudge to align with content grid (same tweak we used) */
    .footer .container{ padding-left: 28px; }
    @media (max-width:768px){ .footer .container{ padding-left: 40px; } }
  </style>
</head>
<body>
  <!-- Header -->
  <header aria-label="Primary Navigation">
    <div class="container nav">
      <a class="brand-logo" href="index.html" aria-label="Scent Story Home">
        <img src="images/brandlogofin.png" alt="Scent Story logo">
      </a>
      <span class="brand-text">Scent Story</span>
      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Open menu">
        <i class="fa-solid fa-bars"></i>
      </button>
      <nav id="primary-nav" class="menu">
        <a href="index.html" style="color:#ffc400 ;">Home</a>
        <details>
          <summary>Explore Chapters â–¾</summary>
          <div class="dropdown" role="menu" aria-label="Explore Chapters">
            <strong style="margin:6px 0 4px; color:#ffc400">By Concentration</strong>
            <a href="pdp1.html?cat=edp">EDP</a>
            <a href="pdp1.html?cat=parfum">Parfum</a>
            <a href="pdp1.html?cat=elixir">Elixir</a>
            <hr style="border:none;border-top:1px solid var(--stroke);margin:8px 0">
            <strong style="margin:6px 0 4px; color:#ffc400">By Mood</strong>
            <a href="pdp1.html?tag=ambition">Ambition</a>
            <a href="pdp1.html?tag=bold">Bold</a>
            <a href="pdp1.html?tag=carefree">Carefree</a>
            <a href="pdp1.html?tag=power">Power</a>
            <a href="pdp1.html?tag=seasons">Seasons</a>
          </div>
        </details>
        <a href="track.html" style="color:#ffc400 ;">Track My Order</a>
        <a href="wishlist.html" style="color:#ffc400 ;">Wishlist</a>
        <a href="contact.html" style="color:#ffc400 ;">Contact</a>
        <a href="cart.html" style="color:#ffc400 ;">Cart</a>
      </nav>
      <div class="quick-actions">
        <a href="login.html" style="color:#e5b822 ;" class="icon-btn" aria-label="Login / Account"><i class="fa-regular fa-user" aria-hidden="true"></i><span>Login</span></a>
        <a href="track.html" style="color:#e5b822 ; " class="icon-btn" aria-label="View my orders"><i class="fa-solid fa-box" aria-hidden="true"></i><span>Orders</span></a>
      </div>
    </div>
  </header>
  <div id="nav-overlay" class="nav-overlay" aria-hidden="true"></div>

  <main>
    <div class="container catalog">
      <h1 class="section-title">Explore Our Collections</h1>
      <p>Tap a scent to see details. Filter by concentration or occasion.</p>

      <!-- Filters -->
      <div class="filters" role="toolbar" aria-label="Filters">
        <div class="filter-group" aria-label="Concentration">
          <button class="chip-filter active" data-cat="all" aria-pressed="true">All</button>
          <button class="chip-filter" data-cat="edp" aria-pressed="false">EDP</button>
          <button class="chip-filter" data-cat="parfum" aria-pressed="false">Parfum</button>
          <button class="chip-filter" data-cat="elixir" aria-pressed="false">Elixir</button>
        </div>
        <div class="filter-group" aria-label="Occasion">
          <label class="visually-hidden" for="occasion-filter">Occasion</label>
          <select id="occasion-filter">
            <option value="all">All occasions </option>
          </select>
        </div>
        <div class="filter-group" aria-label="Search">
          <input id="search" type="search" placeholder="Search scent..." />
        </div>
      </div>

      <!-- Image-only grid -->
      <div id="catalog-grid" class="image-grid" aria-live="polite"></div>
    </div>
  </main>

  <!-- Footer (same component as index) -->
  <footer class="footer">
    <div class="container footer-hero">
      <section class="subscribe-card" aria-labelledby="subscribe-title">
        <h3 id="subscribe-title">Join Our Circle</h3>
        <p>Be first to new launches, private sales, and members-only stories. <strong>New members get 10% off.</strong></p>
        <form id="newsletter-form" class="newsletter-form" novalidate>
          <label class="visually-hidden" for="nl-email">Email</label>
          <input id="nl-email" name="email" type="email" placeholder="Enter your email" required>
          <button type="submit" class="btn-gold">Subscribe</button>
        </form>
        <p id="newsletter-success" class="newsletter-success" role="status" hidden>
          ðŸŽ‰ Thank you! Youâ€™re subscribed. Check your inbox for a welcome note.
        </p>
        <small class="legal">By subscribing you agree to our <a href="#/privacy">Privacy Policy</a>. Unsubscribe anytime.</small>
      </section>
      <section class="membership-card" aria-labelledby="member-title">
        <h3 id="member-title" style="color:#efe2b8;">Scent Story Circle â€” Members Get More</h3>
        <ul class="benefits">
          <li style="color:#ffc400"> Early access to new Chapters</li>
          <li style="color:#ffc400">Free sample with orders</li>
          <li style="color:#ffc400">Birthday reward</li>
          <li style="color:#ffc400">Priority support</li>
        </ul>
        <a class="btn-outline member-btn" href="contact.html" aria-label="Become a member">Become a Member</a>
      </section>
    </div>
    <div class="container footer-links">
      <div class="col">
        <h4>Brand</h4>
        <a href="about.html">About Us</a>
        <a href="about.html#craft">Craft & Safety</a>
        <a href="about.html#press">Press</a>
      </div>
      <div class="col">
        <h4>Shop</h4>
        <a href="#edp">EDP</a>
        <a href="#parfum">Parfum</a>
        <a href="#elixir">Elixir</a>
        <a href="pdp.html">Gift Ideas</a>
      </div>
      <div class="col">
        <h4>Support</h4>
        <a href="track.html">Track My Order</a>
        <a href="#/shipping">Shipping</a>
        <a href="#/returns">Returns</a>
        <a href="support.html/grievance">Grievances</a>
        <a href="contact.html">Contact</a>
      </div>
      <div class="col">
        <h4>Legal</h4>
        <a href="#/terms">Terms of Service</a>
        <a href="#/privacy">Privacy Policy</a>
        <a href="#/privacy">Cookies & Consent</a>
        <a href="about.html">Accessibility</a>
      </div>
    </div>
    <div class="container footer-trust">
      <p>Phthalate-Free â€¢ Cruelty-Free â€¢ IFRA &amp; FDA Compliant â€¢ Secure Checkout</p>
    </div>
    <div class="container footer-bottom">
      <div class="payments">
        <i class="fa-brands fa-cc-visa" aria-hidden="true" title="Visa"></i>
        <i class="fa-brands fa-cc-mastercard" aria-hidden="true" title="Mastercard"></i>
        <i class="fa-brands fa-cc-amex" aria-hidden="true" title="American Express"></i>
        <i class="fa-brands fa-cc-paypal" aria-hidden="true" title="PayPal"></i>
        <span class="badge-upi" aria-label="UPI accepted">UPI</span>
      </div>
      <div class="social-icons" aria-label="Social media">
        <a href="https://facebook.com" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://instagram.com" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
        <a href="https://twitter.com" target="_blank" rel="noopener noreferrer" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
      </div>
      <div class="copyright">Â© <span id="year"></span> Scent Story. All Rights Reserved.</div>
    </div>
  </footer>

  <script>
    // Safe year update
    (function(){ const y=document.getElementById('year'); if(y) y.textContent = new Date().getFullYear(); })();

    // ===== Catalog Data (image-only tiles) =====
    const PRODUCTS = [
      // EDP
      {type:'edp', slug:'first-date', name:'First Date', images:['images/FirstDate.png','images/firstdate1.png'], occasions:['date','everyday'], tags:['carefree','seasons']},
      {type:'edp', slug:'fresh-salt', name:'Fresh Salt', images:['images/Fresh Salt.png','images/freshsalt1.png'], occasions:['summer','fresh','everyday'], tags:['carefree','seasons']},
      {type:'edp', slug:'beast', name:'Beast', images:['images/Beast.png','images/beast1.png'], occasions:['night','club','bold'], tags:['bold']},
      {type:'edp', slug:'boardroom', name:'Boardroom', images:['images/Boardroom.png','images/boardroom1.png'], occasions:['office','formal','power'], tags:['power','ambition']},
      {type:'edp', slug:'summer-drift', name:'Summer Drift', images:['images/Summer Drift.png','images/summerdrift1.png'], occasions:['summer','casual'], tags:['carefree','seasons']},
      // Parfum
      {type:'parfum', slug:'victory-night', name:'Victory Night', images:['images/Victory Night.png','images/victorynight1.png'], occasions:['night','date','win'], tags:['ambition','bold']},
      {type:'parfum', slug:'nocturne', name:'Nocturne', images:['images/Nocturne.png','images/nocturne1.png'], occasions:['night','mystery'], tags:['bold']},
      {type:'parfum', slug:'ambre-royale', name:'Ambre Royale', images:['images/Ambre Royale.png','images/ambreroyale1.png'], occasions:['formal','signature'], tags:['power','ambition']},
      {type:'parfum', slug:'tropical-escape', name:'Tropical Escape', images:['images/Tropical Escape.png','images/tropicalescape1.png'], occasions:['summer','vacation','fresh'], tags:['carefree','seasons']},
      {type:'parfum', slug:'winter-embrace', name:'Winter Embrace', images:['images/Winter Embrace.png','images/winterembrace1.png'], occasions:['winter','cozy','formal'], tags:['seasons','power']},
      {type:'parfum', slug:'the-icon', name:'The Icon', images:['images/Icon.png','images/icon1.png'], occasions:['signature','formal','office'], tags:['ambition','power']},
      // Elixir
      {type:'elixir', slug:'ceo-elixir', name:'CEO â€” Elixir', images:['images/CEO.png','images/marque bannerelixir.png'], occasions:['office','power','formal'], tags:['power','ambition']},
      {type:'elixir', slug:'autumn-fire', name:'Autumn Fire', images:['images/Autumn Fire.png','images/autumnfire1.png'], occasions:['fall','evening','bold'], tags:['bold','seasons']},
      {type:'elixir', slug:'forever-love', name:'Forever Love', images:['images/Forever Love.png','images/foreverlove1.png'], occasions:['date','romantic'], tags:['carefree']},
      {type:'elixir', slug:'boardroom-elixir', name:'Boardroom â€” Elixir', images:['images/Boardroom Elixir.png','images/boardroomelixir1.png'], occasions:['office','power'], tags:['power','ambition']},
      {type:'elixir', slug:'beast-elixir', name:'Beast â€” Elixir', images:['images/Beast Elixir.png','images/beastelixir1.png'], occasions:['night','bold'], tags:['bold']},
    ];

    // Build occasion options dynamically from products
    const occSelect = document.getElementById('occasion-filter');
    const occSet = new Set(['all']);
    PRODUCTS.forEach(p => (p.occasions||[]).forEach(o => occSet.add(o)) );
    [...occSet].filter(o=>o!=='all').sort().forEach(o=>{
      const opt=document.createElement('option'); opt.value=o; opt.textContent=o.charAt(0).toUpperCase()+o.slice(1);
      occSelect.appendChild(opt);
    });

    // Helpers
    function preload(url){
      return new Promise(resolve=>{ const im=new Image(); im.onload=()=>resolve({ok:true,url}); im.onerror=()=>resolve({ok:false,url}); im.src=url; });
    }

    function tileHTML(p,primary,alt){
      return `
        <article class="tile" data-cat="${p.type}" data-occ="${(p.occasions||[]).join(',')}" data-tags="${(p.tags||[]).join(',')}">
          <a href="pdp.html#${p.slug}" aria-label="${p.name}">
            <div class="img-stack" aria-hidden="true">
              <img class="img-primary" src="${primary}" alt="${p.name} primary">
              ${alt ? `<img class=\"img-alt\" src=\"${alt}\" alt=\"${p.name} alternate\">` : ''}
            </div>
            <div class="meta"><span class="pill">${p.type.toUpperCase()}</span></div>
            <div class="caption">${p.name}</div>
          </a>
        </article>`;
    }

    async function buildGrid(){
      const grid = document.getElementById('catalog-grid');
      grid.innerHTML = '';
      // Preload primary & alt (first two images), gracefully handle missing
      for(const p of PRODUCTS){
        const [p0,p1] = p.images||[];
        const res = await Promise.all([preload(p0), p1?preload(p1):Promise.resolve({ok:false,url:null})]);
        const primary = res[0].ok ? res[0].url : null;
        const alt = res[1].ok ? res[1].url : null;
        if(primary){ grid.insertAdjacentHTML('beforeend', tileHTML(p, primary, alt)); }
      }
      // initial stagger reveal
      const tiles = Array.from(document.querySelectorAll('#catalog-grid .tile'));
      tiles.forEach((t,i)=> setTimeout(()=> t.classList.add('reveal'), i*60));
    }

    function applyFilters(){
      const activeCat = document.querySelector('.chip-filter.active')?.dataset.cat || 'all';
      const occ = document.getElementById('occasion-filter').value;
      const q = document.getElementById('search').value.trim().toLowerCase();
      const tag = (new URL(location.href)).searchParams.get('tag')?.toLowerCase() || '';

      document.querySelectorAll('#catalog-grid .tile').forEach(tile=>{
        const catOk = (activeCat==='all') || (tile.dataset.cat===activeCat);
        const occOk = (occ==='all') || (tile.dataset.occ||'').split(',').includes(occ);
        const name = tile.querySelector('.caption')?.textContent.toLowerCase()||'';
        const qOk = !q || name.includes(q);
        const tagOk =
          !tag ||
          (tile.dataset.tags||'').split(',').includes(tag) ||
          (tag==='seasons' && ((tile.dataset.occ||'').includes('summer') || (tile.dataset.occ||'').includes('winter') || (tile.dataset.occ||'').includes('fall')));
        tile.style.display = (catOk && occOk && qOk && tagOk) ? '' : 'none';
      });
    }

    // Wire filters (with confetti + reveal)
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.chip-filter');
      if(!btn) return;

      // Toggle active state
      document.querySelectorAll('.chip-filter').forEach(b=>{ b.classList.remove('active'); b.setAttribute('aria-pressed','false'); });
      btn.classList.add('active'); btn.setAttribute('aria-pressed','true');

      // Confetti burst
      const burst = (n=12)=>{
        const box = btn.getBoundingClientRect();
        for(let i=0;i<n;i++){
          const span = document.createElement('span');
          span.className='confetti';
          const angle = Math.random()*2*Math.PI;
          const dist = 40 + Math.random()*40;
          span.style.setProperty('--dx', `${Math.cos(angle)*dist}px`);
          span.style.setProperty('--dy', `${Math.sin(angle)*dist}px`);
          span.style.left = (box.width/2)+'px';
          span.style.top = (box.height/2)+'px';
          btn.style.position='relative';
          btn.appendChild(span);
          setTimeout(()=> span.remove(), 900);
        }
      };
      burst();

      applyFilters();

      // Stagger reveal visible tiles
      const tiles = Array.from(document.querySelectorAll('#catalog-grid .tile')).filter(t=> t.style.display !== 'none');
      tiles.forEach((t,i)=>{
        t.classList.remove('reveal');
        setTimeout(()=> t.classList.add('reveal'), i*60);
      });
    });
    document.getElementById('occasion-filter').addEventListener('change', applyFilters);
    document.getElementById('search').addEventListener('input', applyFilters);

    // URL-driven preselect (cat, occ, q, tag)
    function setCategory(cat){
      const target = document.querySelector(`.chip-filter[data-cat="${cat}"]`) || document.querySelector('.chip-filter[data-cat="all"]');
      if(!target) return;
      document.querySelectorAll('.chip-filter').forEach(b=>{ b.classList.remove('active'); b.setAttribute('aria-pressed','false'); });
      target.classList.add('active'); target.setAttribute('aria-pressed','true');
      applyFilters();
    }
    function initFromURL(){
      const url = new URL(location.href);
      const cat = (url.searchParams.get('cat')||'').toLowerCase();
      const occ = (url.searchParams.get('occ')||'').toLowerCase();
      const q = (url.searchParams.get('q')||'');
      const tag = (url.searchParams.get('tag')||'');
      if(cat){ setCategory(cat); }
      if(occ){
        const sel=document.getElementById('occasion-filter');
        if(sel){ sel.value = sel.querySelector(`option[value="${occ}"]`) ? occ : 'all'; }
      }
      if(q){ const s=document.getElementById('search'); if(s){ s.value=q; } }
      applyFilters();
      // highlight filters if tag in use
      if(tag){
        const filters = document.querySelector('.filters');
        if(filters) filters.scrollIntoView({behavior:'smooth', block:'start'});
      }
      // stagger reveal after URL filters
      const tiles = Array.from(document.querySelectorAll('#catalog-grid .tile')).filter(t=> t.style.display !== 'none');
      tiles.forEach((t,i)=> setTimeout(()=> t.classList.add('reveal'), i*60));
    }

    // Init
    (async function(){ await buildGrid(); initFromURL(); })();
    window.addEventListener('popstate', initFromURL);
  </script>
  <!-- Shared main script (menu toggle, etc.) -->
  <script src="js/main.js" defer></script>
</body>
</html>